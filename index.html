<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Premium Sohbet — Single File</title>
<style>
:root{
  --bg:#071022; --card:#071127; --muted:#94a3b8; --accent:#6ee7b7; --accent-2:#7c3aed; --glass: rgba(255,255,255,0.04);
  --radius:12px; --glass-2: rgba(255,255,255,0.02);
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;color:#e6eef8;background:var(--bg);}
.container{max-width:1200px;margin:16px auto;padding:12px}
.app{display:grid;grid-template-columns:300px 1fr;gap:18px}
.sidebar{background:linear-gradient(180deg,var(--card), #06101a);padding:16px;border-radius:12px;min-height:80vh;box-shadow:0 8px 40px rgba(2,6,23,0.6);}
.brand{display:flex;gap:12px;align-items:center;margin-bottom:12px;}
.logo{width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;font-weight:800;}
.controls{display:flex;gap:8px;align-items:center;}
.btn{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:10px;color:var(--muted);cursor:pointer;}
.primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));border:none;color:#031016;}
.rooms{margin-top:12px;}
.room{padding:10px;border-radius:10px;display:flex;align-items:center;gap:10px;cursor:pointer;}
.room:hover{background:rgba(255,255,255,0.02);}
.active{background:linear-gradient(90deg, rgba(124,58,237,0.12), rgba(110,231,183,0.04));border:1px solid rgba(124,58,237,0.1);}
.main{min-height:80vh;padding:12px;border-radius:12px;display:flex;flex-direction:column;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));}
.header{display:flex;justify-content:space-between;align-items:center;padding:8px;}
.chat-window{flex:1;overflow:auto;padding:12px;border-radius:12px;background:linear-gradient(180deg,var(--glass-2),transparent);}
.composer{display:flex;gap:8px;padding:10px;border-top:1px solid rgba(255,255,255,0.03);}
.input{flex:1;padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit;}
.message{display:flex;gap:12px;margin-bottom:10px;align-items:flex-start;}
.avatar{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;}
.bubble{background:linear-gradient(180deg,#071429, #07122b);padding:10px;border-radius:12px;max-width:75%;box-shadow:0 6px 18px rgba(2,6,23,0.6);}
.me{flex-direction:row-reverse;}
.me .bubble{background:linear-gradient(90deg,var(--accent), rgba(110,231,183,0.06));color:#051318;}
.meta{font-size:12px;color:var(--muted);margin-top:6px;}
.small{font-size:12px;color:var(--muted);}
.toolbar{display:flex;gap:8px;}
.search{width:200px;padding:8px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit;}
.badge{padding:6px 10px;border-radius:999px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#031016;font-weight:700;}
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(2,6,23,0.6);z-index:60;}
.card{background:linear-gradient(180deg,#071127,#071022);padding:18px;border-radius:12px;min-width:320px;max-width:900px;}
.settings-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.user-list{margin-top:12px;max-height:30vh;overflow:auto;}
.user-item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:8px;}
.file-preview{max-width:240px;border-radius:8px;margin-top:8px;border:1px solid rgba(255,255,255,0.04);}
.reaction{display:inline-block;padding:6px;border-radius:8px;margin-right:6px;}
.split{display:flex;gap:12px;}
.stats{display:flex;gap:12px;}
@media(max-width:980px){.app{grid-template-columns:1fr}.sidebar{order:2}.main{order:1}.search{width:120px}}
.theme-neon{--accent:#00FFF0;--accent-2:#FF00D6; background:linear-gradient(180deg,#03010a,#060316);}
.theme-matrix{--accent:#00c853;--accent-2:#b2ff59;background:linear-gradient(180deg,#010201,#001003);}
.theme-minimal{--accent:#2b6cb0;--accent-2:#2c5282;background:linear-gradient(180deg,#f7fafc,#ffffff);color:#051323;}
.muted{color:var(--muted);}
.pill{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);}
</style>
</head>
<body>
<div class="container" id="root">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
    <div style="display:flex;gap:12px;align-items:center"><div style="font-weight:800;font-size:18px">Premium Sohbet — Single File</div></div>
    <div style="display:flex;gap:8px;align-items:center">
      <button class="btn" id="btnSimGoogle">Google ile Giriş (simülasyon)</button>
      <button class="btn" id="btnSimDiscord">Discord ile Giriş (simülasyon)</button>
      <button class="btn" id="btnSignout">Çıkış</button>
    </div>
  </div>

  <div class="app" id="appWrap">
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="logo">PS</div>
        <div><div style="font-weight:800">Premium Sohbet</div><div class="small muted" id="tagline">Tek dosya demo</div></div>
      </div>
      <div class="controls">
        <button class="btn" id="btnProfile">Profil</button>
        <button class="btn" id="btnSettings">Ayarlar</button>
        <span style="flex:1"></span>
        <span class="badge" id="premiumBadge">Premium</span>
      </div>
      <div style="margin-top:12px">
        <div style="display:flex;justify-content:space-between;align-items:center"><div class="muted">Odalar</div><div class="small muted" id="roomCount">0</div></div>
        <div class="rooms" id="rooms"></div>
      </div>
      <hr style="border:none;height:1px;background:rgba(255,255,255,0.02);margin:12px 0">
      <div style="display:flex;justify-content:space-between;align-items:center"><div class="muted">Kullanıcılar</div><div class="small">Çoklu-tab</div></div>
      <div class="user-list" id="userList"></div>
      <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
        <input id="quickRoom" class="input" placeholder="Yeni oda adı" />
        <button class="btn primary" id="createRoom">Oluştur</button>
      </div>
      <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn" id="btnRPS">Taş-Kâğıt-Makas</button>
        <button class="btn" id="btnQuiz">Hızlı Quiz</button>
        <button class="btn" id="btnStats">İstatistikler</button>
      </div>
    </aside>

    <main class="main" id="main">
      <div class="header">
        <div style="display:flex;gap:12px;align-items:center">
          <div id="currentRoomTitle" style="font-weight:800"># Genel</div>
          <div class="small muted" id="roomDesc">Herkese açık oda</div>
        </div>
        <div class="toolbar">
          <input class="search" id="searchMessages" placeholder="Mesajlarda ara..." />
          <select id="themeSelect" class="input" style="width:140px">
            <option value="">Tema: Varsayılan</option>
            <option value="neon">Neon</option>
            <option value="matrix">Matrix</option>
            <option value="minimal">Minimal</option>
          </select>
          <button class="btn" id="btnEmojis">🙂</button>
        </div>
      </div>
      <div class="chat-window" id="chatWindow"></div>
      <div class="composer">
        <input id="messageInput" class="input" placeholder="Mesaj yaz... (Markdown destekli)" />
        <input type="file" id="fileInput" style="display:none" />
        <button class="btn" id="attachBtn">📎</button>
        <button class="btn" id="btnNotify">🔔 Bildirim Testi</button>
        <button class="btn primary" id="sendBtn">Gönder</button>
      </div>
    </main>
  </div>
  <div style="margin-top:12px;font-size:12px;color:var(--muted)">NOT: Gerçek OAuth ve server-side özellikler yok, bu sürüm tamamen client-side çalışır.</div>
</div>

<script>
// Tek dosya chat sitesi demo JS
const state=JSON.parse(localStorage.getItem('ps_full_state')||'null')||{rooms:[{id:'general',name:'# Genel',desc:'Herkese açık oda'}],currentRoom:'general',username:'Kullanici'+Math.floor(Math.random()*9999),messages:{},users:{},premium:false,notify:true,readReceipts:true,stats:{messages:0,perUser:{}}};
const channel=(window.BroadcastChannel)?new BroadcastChannel('ps_full_chan'):null;
if(channel){channel.onmessage=ev=>handleIncoming(ev.data);}
const el=id=>document.getElementById(id);
const saveState=()=>localStorage.setItem('ps_full_state',JSON.stringify(state));
const uid=(n=8)=>Math.random().toString(36).slice(2,2+n);

function announce(kind='update'){state.users[state.username]={name:state.username,last:Date.now(),avatar:avatarFor(state.username),premium:state.premium,bio:state.bio||''};saveState();if(channel)channel.postMessage({type:'presence',user:state.users[state.username],kind});renderUsers();}
function handleIncoming(msg){if(!msg)return;if(msg.type==='message'){state.messages[msg.room]=state.messages[msg.room]||[];state.messages[msg.room].push(msg.payload);incrementStats(msg.payload.from);saveState();if(msg.room===state.currentRoom)renderChat();}else if(msg.type==='presence'){state.users[msg.user.name]=msg.user;saveState();renderUsers();}}
function avatarFor(name){const letc=(name||'U').slice(0,1).toUpperCase();const hue=Math.abs([...name].reduce((s,c)=>s+c.charCodeAt(0),0))%360;const bg=`linear-gradient(90deg,hsl(${hue} 70% 50%), hsl(${(hue+45)%360} 70% 45%))`;return {let:letc,bg};}
function init(){renderRooms();renderUsers();renderChat();bindEvents();announce('join');updateProfileUI();}
function renderRooms(){const wrap=el('rooms');wrap.innerHTML='';state.rooms.forEach(r=>{const d=document.createElement('div');d.className='room'+(r.id===state.currentRoom?' active':'');d.innerHTML=`<div style="width:10px"></div><div style="flex:1">${r.name}</div><div class="small muted">${r.desc||''}</div>`;d.onclick=()=>{state.currentRoom=r.id;saveState();renderRooms();renderChat();el('currentRoomTitle').innerText=r.name;el('roomDesc').innerText=r.desc||'';};wrap.appendChild(d);});el('roomCount').innerText=state.rooms.length;}
function renderUsers(){const uwrap=el('userList');uwrap.innerHTML='';Object.values(state.users).forEach(u=>{const it=document.createElement('div');it.className='user-item';it.innerHTML=`<div class="avatar" style="background:${u.avatar.bg}">${u.avatar.let}</div><div style="flex:1"><div style="font-weight:700">${u.name}${u.premium?' ⭐':''}</div><div class="small muted">Son: ${timeAgo(u.last)} ${u.bio? (u.premium? u.bio : '(premium)'):''}</div></div>`;uwrap.appendChild(it);});}
function renderChat(filter){const win=el('chatWindow');win.innerHTML='';const msgs=(state.messages[state.currentRoom]||[]).slice(-1000);msgs.filter(m=>!filter||m.text.toLowerCase().includes(filter.toLowerCase())).forEach(m=>{const wrapper=document.createElement('div');wrapper.className='message'+(m.from===state.username?' me':'');const av=document.createElement('div');av.className='avatar';av.innerText=avatarFor(m.from).let;av.style.background=avatarFor(m.from).bg;const bubble=document.createElement('div');bubble.className='bubble';bubble.innerHTML=`<div class="author">${m.from}${m.edited?' • düzenlendi':''}</div><div class="text">${m.deleted?'<i>Mesaj silindi</i>':escapeHtml(m.text||'')}</div>`;if(m.file){const p=document.createElement('div');p.className='file-preview';if(m.file.type&&m.file.type.startsWith('image/')){p.innerHTML=`<img src="${m.file.data}" style="max-width:100%;border-radius:8px">`;}else{p
